// ----------------------------------------------
// Tooltip (.[prefix-]toooltip)
// ----------------------------------------------

@import '../config/all';
@import '../utils/all';
@import '../icons/base-mixins';
@import '../icons/icon-mixins';

@include exports('tooltip') {
  #{$config-class-prefix} {

    // Rich text tooltip styles
    // ----------------------------------------------
    &tooltip {
      @include tooltip();
      @include tooltip-position-right();
      @include tooltip-alignment-center-y();
      display: none;
      transition: opacity 200ms;
      opacity: 0;

      &::before {
        z-index: 0;
      }

      &::after {
        position: absolute;
        z-index: 0;

        @include arrow('left');
      }

      &--small {
        width: 150px;
        min-height: auto;

        // if is not ie11
        @supports (width: max-content) {
          width: auto;
          white-space: nowrap;
        }
      }

      &--error {
        @include tooltip-error-state();

        &::after {
          @include arrow('left', $tooltip-error-bg-color);
        }
      }

      &::after {
        @include arrow-position-left();
        @include arrow-alignment-center-y();
      }

      &--start {
        @include tooltip-alignment-start-y();

        &::after {
          @include arrow-alignment-start-y();
        }
      }

      &--end {
        @include tooltip-alignment-end-y();

        &::after {
          @include arrow-alignment-end-y();
        }
      }

      &--active {
        display: flex;
        justify-content: space-between;
        opacity: 1;
      }

      // @todo sort out and simplify positioning styles and optimize them
      // Makes tooltip to appear to the left
      &--left {
        @include tooltip-position-left();
        @include tooltip-alignment-center-y();

        &::after {
          @include arrow('right');
          @include arrow-position-right();
          @include arrow-alignment-center-y();
        }

        &#{$config-class-prefix}tooltip--error::after {
          @include arrow('right', $tooltip-error-bg-color);
        }

        &#{$config-class-prefix}tooltip--start {
          @include tooltip-alignment-start-y();

          &::after {
            @include arrow-alignment-start-y();
          }
        }

        &#{$config-class-prefix}tooltip--end {
          @include tooltip-alignment-end-y();

          &::after {
            @include arrow-alignment-end-y();
          }
        }
      }

      // Makes tooltip to appear on top
      &--top {
        @include tooltip-position-top();
        @include tooltip-alignment-center-x();

        &::after {
          @include arrow('bottom');
          @include arrow-position-bottom();
          @include arrow-alignment-center-x();
        }

        &#{$config-class-prefix}tooltip--error::after {
          @include arrow('bottom', $tooltip-error-bg-color);
        }

        &#{$config-class-prefix}tooltip--start {
          @include tooltip-alignment-start-x();

          &::after {
            @include arrow-alignment-start-x();
          }
        }

        &#{$config-class-prefix}tooltip--end {
          @include tooltip-alignment-end-x();

          &::after {
            @include arrow-alignment-end-x();
          }
        }
      }

      // Makes tooltip to appear at the bottom
      &--bottom {
        @include tooltip-position-bottom();
        @include tooltip-alignment-center-x();

        &::after {
          @include arrow('top');
          @include arrow-position-top();
          @include arrow-alignment-center-x();
        }

        &#{$config-class-prefix}tooltip--error::after {
          @include arrow('top', $tooltip-error-bg-color);
        }

        &#{$config-class-prefix}tooltip--start {
          @include tooltip-alignment-start-x();

          &::after {
            @include arrow-alignment-start-x();
          }
        }

        &#{$config-class-prefix}tooltip--end {
          @include tooltip-alignment-end-x();

          &::after {
            @include arrow-alignment-end-x();
          }
        }
      }

      &__content {
        position: relative;
        flex: auto;
        text-align: left;
        z-index: z(base);

        // on small tooltips the padding should be halved,
        // this hack reduces half the size of the padding from the margin
        // so we don't need to rewrite all of the paddings for each
        // positioning variable :big_brain:
        #{$config-class-prefix}tooltip--small & {
          margin: calc(-1 * #{cssvar(spacing-xxs)});
        }
      }

      &__close {
        @include btn-reset();
        @include flix-svg-icon-small;
        position: relative;
        align-self: flex-start;
        background: cssvar(icon-close) no-repeat center;
        // making this same size as font icons
        // @todo verify proper icon size and remove this in 4.0
        background-size: 20px;
        z-index: z(base);

        // @todo deprecating flix icon usage, icon needs to be removed from HTML in 4.0
        #{$config-class-prefix}icon {
          display: none;
        }
      }

      &--error &__close {
        background-image: cssvar(icon-panel-close);
      }
    }

    // wrapper that makes is possible to position the tooltip correctly
    // should be added around or to the element that triggers tooltip
    &tooltip-target {
      position: relative;

      &--inline {
        display: inline-block;
      }
    }
  }
}
