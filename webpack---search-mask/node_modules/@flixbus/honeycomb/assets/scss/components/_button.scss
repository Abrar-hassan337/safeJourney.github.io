// ----------------------------------------------
// Button (.prefix-btn)
// ----------------------------------------------

@import '../themes/theme-colors'; //@todo themes inclusion should only be happening in base file
@import '../config/all';
@import '../utils/all';

// ------------------------------------
// style variables
// ------------------------------------
$button-size: 36px; // defines heights and width for square buttons, used for height only in others
$button-size-mobile: 44px;
$button-font-size: cssvar(font-size-button);
$button-font-weight: cssvar(font-weight-semibold);
$button-line-height: 24px;
$button-bg-color: cssvar(grayscale-0-color);
$button-hover-bg-color: cssvar(grayscale-10-color);
$button-text-color: cssvar(primary-content-color);
$button-primary-bg-color: cssvar(secondary-ui-color);
$button-primary-hover-bg-color: cssvar(secondary-ui-dark-color);
$button-primary-text-color: $plain-white-color;
$button-secondary-bg-color: cssvar(primary-ui-color);
$button-secondary-hover-bg-color: cssvar(primary-ui-dark-color);
$button-secondary-text-color: $plain-white-color;
$button-tertiary-bg-color: transparent;
$button-tertiary-hover-bg-color: cssvar(primary-ui-dark-color);
$button-tertiary-text-color: cssvar(primary-ui-color);
$button-tertiary-hover-text-color: $plain-white-color;
$button-danger-bg-color: cssvar(danger-color);
$button-danger-hover-bg-color: cssvar(danger-dark-color);
$button-danger-text-color: $plain-white-color;
$button-disabled-text-color: $plain-white-color;
$button-radius: cssvar(primary-border-radius);
$button-loading-spinner-size: 24px;
$button-spinner-color: rgba(0, 0, 0, 0.2);
$button-spinner-slice-color: rgba(0, 0, 0, 0.6);

#{$config-class-prefix} {
  &btn {
    display: inline-block;
    position: relative;
    width: 100%;
    min-width: 142px;
    max-width: 100%;
    height: $button-size-mobile; // compensating the borders
    padding: 0 cssvar(spacing-xs);
    transition: background 250ms linear;
    border: 1px solid cssvar(grayscale-50-color);
    border-radius: $button-radius;
    background: $button-bg-color;
    color: $button-text-color;
    font-family: inherit;
    font-size: $button-font-size;
    font-weight: $button-font-weight;
    line-height: $button-size-mobile - 2; // compensating the borders
    text-align: center;
    text-decoration: none;
    text-overflow: ellipsis;
    white-space: nowrap; // no multiline content in buttons allowed
    cursor: pointer;
    overflow: hidden;
    vertical-align: middle;
    // getting rid of default iOS webkit styles
    appearance: none;

    // we want hover for enabled buttons and links only
    &:enabled:hover,
    &[href]:hover,
    &:active,
    &#{$config-class-prefix}btn--loading {
      background: $button-hover-bg-color;
      text-decoration: none;
    }

    @include on-bp(sm) {
      width: auto;
    }

    @include on-bp(xl) {
      height: $button-size; // compensating the borders
      line-height: $button-size - 2; // compensating the borders
    }

    // buttons side-by-side have default margin
    // @todo reconsider supporting this in favour of grid usage or button group elements
    & + & {
      margin-top: cssvar(spacing-xs);

      @include on-bp(sm) {
        margin-top: 0;
        margin-left: cssvar(spacing-xs);
      }
    }

    &--block {
      display: block;
      width: 100%;
    }

    &--square {
      width: $button-size-mobile;
      min-width: auto;
      padding: 0;
      // no multiline text allowed, cut everything that exceeds button's width
      overflow: hidden;

      @include on-bp(xl) {
        width: $button-size;
      }

      // square buttons don't have top margins since they don't fill the container
      & + & {
        margin-top: 0;
        margin-left: cssvar(spacing-xs);
      }
    }

    &--primary {
      border: 0;
      background: $button-primary-bg-color;
      color: $button-primary-text-color;
      line-height: $button-size-mobile;

      @include on-bp(xl) {
        line-height: $button-size;
      }

      // we want hover for enabled buttons and links only
      &:enabled:hover,
      &[href]:hover,
      &:active,
      &#{$config-class-prefix}btn--loading {
        background: $button-primary-hover-bg-color;
        text-decoration: none;
      }

      &#{$config-class-prefix}btn--loading::before {
        filter: invert(100%);
      }
    }

    &--secondary {
      border: 0;
      background: $button-secondary-bg-color;
      color: $button-secondary-text-color;
      line-height: $button-size-mobile;

      @include on-bp(xl) {
        line-height: $button-size;
      }

      // we want hover for enabled buttons and links only
      &:enabled:hover,
      &[href]:hover,
      &:active,
      &#{$config-class-prefix}btn--loading {
        background: $button-secondary-hover-bg-color;
        text-decoration: none;
      }

      &#{$config-class-prefix}btn--loading::before {
        filter: invert(100%);
      }
    }

    &--danger {
      border: 0;
      background: $button-danger-bg-color;
      color: $button-danger-text-color;
      line-height: $button-size-mobile;

      @include on-bp(xl) {
        line-height: $button-size;
      }

      // we want hover for enabled buttons and links only
      &:enabled:hover,
      &[href]:hover,
      &:active,
      &#{$config-class-prefix}btn--loading {
        background: $button-danger-hover-bg-color;
        text-decoration: none;
      }

      &#{$config-class-prefix}btn--loading::before {
        filter: invert(100%);
      }
    }

    &--tertiary {
      // compensating the border width to preserve the same button height
      border: 1px solid $button-tertiary-text-color;
      background: $button-tertiary-bg-color;
      color: $button-tertiary-text-color;

      // we want hover for enabled buttons and links only
      &:enabled:hover,
      &[href]:hover,
      &:active,
      &#{$config-class-prefix}btn--loading {
        background-color: $button-tertiary-hover-bg-color;
        color: $button-tertiary-hover-text-color;
        text-decoration: none;
      }

      &#{$config-class-prefix}btn--loading::before {
        filter: invert(100%);
      }
    }

    &:disabled,
    &--disabled {
      cursor: not-allowed;
      opacity: cssvar(disabled-element-opacity);
    }

    &--loading {
      // animated rounded spinner
      &::before {
        display: inline-block;
        // min-width is enough for flexbox, it doesn't allow element to shrink in size
        width: $button-loading-spinner-size;
        height: $button-loading-spinner-size;
        margin-top: -2px; // helps center loader properly, @todo investigate for a better way
        margin-right: .5em;
        border: 4px solid $button-spinner-color;
        border-radius: 50%;
        border-left-color: $button-spinner-slice-color;
        content: '';
        vertical-align: middle;
        animation: btn-spinner-rotate 1s infinite linear, btn-spinner-grow 250ms;
      }
      @include anim-grow-fade(
        $anim-name: 'btn-spinner-grow',
        $to-width: $button-loading-spinner-size,
        $to-height: $button-loading-spinner-size
      );
      @include anim-rotate(
        $anim-name: 'btn-spinner-rotate'
      )
    }

    &--has-icon {
      &#{$config-class-prefix}btn--loading {
        &:before {
          margin-left: .5em; // helps center loader properly
        }

        #{$config-class-prefix}btn__icon {
          display: none; // icons get replaced with the loader in square buttons
        }
      }
    }

    &--link {
      width: auto;
      min-width: 0;
      padding: 0;
      border: 0;
      background: transparent;

      & + & {
        margin-top: 0;
        margin-left: cssvar(spacing-xs);
      }

      &:enabled:hover,
      &[href]:hover,
      &:active,
      &#{$config-class-prefix}btn--loading {
        border: 0;
        background: transparent;
      }

      &#{$config-class-prefix}btn--loading::before {
        margin-left: 0;
        filter: none;
      }

      & #{$config-class-prefix}btn__icon::before {
        margin-right: 0;
        margin-left: 0;
      }

      &#{$config-class-prefix}btn--primary {
        color: $button-primary-bg-color;

        &:enabled:hover,
        &[href]:hover,
        &:active,
        &#{$config-class-prefix}btn--loading {
          color: $button-primary-hover-bg-color;
        }
      }

      &#{$config-class-prefix}btn--secondary,
      &#{$config-class-prefix}btn--tertiary {
        color: $button-secondary-bg-color;

        &:enabled:hover,
        &[href]:hover,
        &:active,
        &#{$config-class-prefix}btn--loading {
          color: $button-secondary-hover-bg-color;
        }
      }

      &#{$config-class-prefix}btn--danger {
        color: $button-danger-bg-color;

        &:enabled:hover,
        &[href]:hover,
        &:active,
        &#{$config-class-prefix}btn--loading {
          color: $button-danger-hover-bg-color;
        }
      }
    }

    &__icon {
      margin-top: -2px; // helps center loader properly, @todo investigate for a better way
      vertical-align: middle;
    }

    // compensates icon font margin, centers content properly
    &__text {
      margin: 0 0 0 .2em;
    }

    &__icon + &__text {
      margin: 0 .2em 0 0;
    }
  }
}
